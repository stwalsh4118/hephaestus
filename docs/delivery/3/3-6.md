# [3-6] API Endpoint Editor

[Back to task list](./tasks.md)

## Description

Build the API Service endpoint definition UI that renders inside the config panel when an API Service node is selected. Users can add/remove endpoint rows, each with a method dropdown, path input, and JSON response schema text area. This is the most complex config form and is critical for the mock API generation flow in later PBIs.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2026-02-18 09:47:52 | Created | N/A | Proposed | Task file created | AI_Agent |
| 2026-02-18 10:12:32 | Status Change | Proposed | InProgress | Started implementation | AI_Agent |
| 2026-02-18 10:15:07 | Status Change | InProgress | Review | Implementation complete, internal AI review passed | AI_Agent |

## Requirements

1. Port number input field (default 8080)
2. Endpoint list with add/remove functionality
3. Each endpoint row contains:
   - Method dropdown: GET, POST, PUT, DELETE, PATCH
   - Path input: string (e.g., "/users", "/users/:id")
   - Response schema: multi-line text area for free-form JSON schema
4. "Add Endpoint" button appends a new empty row
5. Remove button on each row deletes that endpoint
6. All changes persist to diagram state via `updateNodeConfig`
7. Existing endpoints pre-populate when re-selecting the node

## Implementation Plan

1. Create `frontend/src/components/config/forms/ApiServiceForm.tsx`:
   - Port input at the top
   - Endpoint list rendered as cards/rows
   - Each row: method `<select>`, path `<input>`, schema `<textarea>`
   - Add endpoint button at bottom
   - Remove button per row
2. Wire form to `updateNodeConfig` — on any field change, build the full `ApiServiceConfig` and push to store
3. Register in the form mapping from task 3-5's `index.ts`

## Test Plan

- Form renders with port input and empty endpoint list by default
- "Add Endpoint" creates a new row with default values
- Method dropdown shows all 5 HTTP methods
- Path input accepts free-form text
- Response schema textarea accepts multi-line JSON
- Remove button deletes the correct endpoint row
- All changes persist to node config in the store
- Re-selecting the node pre-populates existing config

## Verification

- TypeScript compilation: PASS
- ESLint: PASS
- Prettier: PASS
- E2E tests: PASS
- Internal AI review: PASS (0 critical, 0 high, 0 medium, 1 low — type-safety gap in handleEndpointChange deferred, functionally safe)

## Files Modified

- `frontend/src/components/config/forms/ApiServiceForm.tsx` — NEW: API endpoint editor with port, method/path/schema per endpoint, add/remove
- `frontend/src/components/config/ConfigPanel.tsx` — Replaced API service placeholder with ApiServiceForm
- `frontend/src/components/config/forms/index.ts` — Added ApiServiceForm export
