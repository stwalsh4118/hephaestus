# [3-5] Service-Specific Config Forms

[Back to task list](./tasks.md)

## Description

Build dynamic configuration forms for PostgreSQL, Redis, Nginx, and RabbitMQ service types that render inside the config panel. Each form presents fields relevant to its service type. Form changes persist to diagram state immediately via the store's `updateNodeConfig` action.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2026-02-18 09:47:52 | Created | N/A | Proposed | Task file created | AI_Agent |
| 2026-02-18 10:09:09 | Status Change | Proposed | InProgress | Started implementation | AI_Agent |
| 2026-02-18 10:12:32 | Status Change | InProgress | Review | Implementation complete, internal AI review passed | AI_Agent |
| 2026-02-18 10:27:34 | Status Change | Review | Done | Task completed and verified | AI_Agent |

## Requirements

1. **PostgreSQL form**: engine dropdown (PostgreSQL only for now), version dropdown (14, 15, 16)
2. **Redis form**: max memory input (string, e.g. "256mb"), eviction policy dropdown (noeviction, allkeys-lru, volatile-lru, allkeys-random)
3. **Nginx form**: upstream servers list (add/remove text inputs for server addresses)
4. **RabbitMQ form**: vhost input (string, default "/")
5. All forms call `updateNodeConfig` on change to persist to diagram state
6. Forms render inside the config panel body based on the selected node's service type
7. API Service form is handled separately in task 3-6

## Implementation Plan

1. Create `frontend/src/components/config/forms/PostgresqlForm.tsx` — engine + version dropdowns
2. Create `frontend/src/components/config/forms/RedisForm.tsx` — maxMemory input + eviction dropdown
3. Create `frontend/src/components/config/forms/NginxForm.tsx` — upstream server list with add/remove
4. Create `frontend/src/components/config/forms/RabbitmqForm.tsx` — vhost input
5. Create `frontend/src/components/config/forms/index.ts` — exports a mapping from `ServiceType` → form component
6. Update `ConfigPanel.tsx` to render the correct form based on the selected node's `data.type`

## Test Plan

- Each form renders the correct fields for its service type
- Changing a form field calls `updateNodeConfig` and persists the value to the node's config
- Selecting a node with existing config pre-populates form fields
- Forms handle empty/default config gracefully

## Verification

- TypeScript compilation: PASS
- ESLint: PASS
- Prettier: PASS
- E2E tests: PASS
- Internal AI review: PASS (0 critical, 0 high, 0 medium, 0 low)

## Files Modified

- `frontend/src/components/config/forms/PostgresqlForm.tsx` — NEW: PostgreSQL config form
- `frontend/src/components/config/forms/RedisForm.tsx` — NEW: Redis config form
- `frontend/src/components/config/forms/NginxForm.tsx` — NEW: Nginx config form
- `frontend/src/components/config/forms/RabbitmqForm.tsx` — NEW: RabbitMQ config form
- `frontend/src/components/config/forms/index.ts` — NEW: Barrel export
- `frontend/src/components/config/ConfigPanel.tsx` — Added ServiceConfigForm switch to render correct form per service type
