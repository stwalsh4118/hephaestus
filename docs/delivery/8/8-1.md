# [8-1] Add Cmd Field to ContainerConfig

[Back to task list](./tasks.md)

## Description

The Docker `ContainerConfig` struct currently lacks a `Cmd` field. Prism requires command-line arguments (`mock -h 0.0.0.0 /path/to/spec.json`) to run in mock mode. Add a `Cmd []string` field to `ContainerConfig` and update the `CreateContainer` method in the Docker engine to pass it through to the Docker API.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2026-02-19 10:19:37 | Created | N/A | Proposed | Task file created | AI_Agent |
| 2026-02-19 13:36:02 | Status Change | Agreed | InProgress | Started implementation | AI_Agent |
| 2026-02-19 13:38:47 | Status Change | InProgress | Review | Implementation complete, internal AI review passed | AI_Agent |
| 2026-02-20 05:12:07 | Status Change | Review | Done | Task completed and verified | AI_Agent |

## Requirements

1. Add `Cmd []string` field to `docker.ContainerConfig` with JSON tag `json:"cmd,omitempty"`
2. Update `CreateContainer` in `engine.go` to pass `Cmd` to the Docker SDK's `container.Config.Cmd` field
3. Existing templates that don't set `Cmd` must continue to work unchanged (nil/empty Cmd means use image default)
4. Update `docs/api-specs/docker/docker-api.md` to document the new field

## Implementation Plan

1. Add `Cmd []string` field to `ContainerConfig` in `backend/internal/docker/types.go`
2. Update `CreateContainer` in `backend/internal/docker/engine.go` to set `Cmd` on the Docker container config
3. Update `docs/api-specs/docker/docker-api.md` — add `Cmd` to the ContainerConfig type documentation
4. Update existing unit tests to verify Cmd is passed through

## Test Plan

- TypeScript compilation equivalent: Go builds without errors
- Existing template tests continue to pass (Cmd is nil by default)
- Unit test: `CreateContainer` with a non-empty `Cmd` includes it in the Docker container config

## Verification

- All existing tests pass (`go test ./...` — 0 failures)
- `go vet ./...` clean
- New tests: `TestCreateContainer_PassesCmdToDockerConfig`, `TestCreateContainer_NilCmdUsesImageDefault` — both pass
- Backward compatibility verified: templates without Cmd continue to work (nil Cmd = image default)
- Internal AI review: pass (0 critical, 0 high, 0 medium, 3 low)

## Files Modified

- `backend/internal/docker/types.go` — Added `Cmd []string` field to `ContainerConfig`
- `backend/internal/docker/engine.go` — Pass `cfg.Cmd` to Docker SDK `container.Config.Cmd`
- `backend/internal/docker/engine_test.go` — Added 2 new tests for Cmd passthrough
- `docs/api-specs/docker/docker-api.md` — Documented `Cmd` field in ContainerConfig type
