# [2-3] Create Zustand Canvas State Store

[Back to task list](./tasks.md)

## Description

Implement a Zustand store that manages the canvas state: nodes, edges, and viewport. This store serves as the single source of truth for all canvas data, ensuring state persists across re-renders and is accessible by all canvas-related components.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2026-02-18 07:33:26 | Created | N/A | Proposed | Task file created | AI_Agent |

## Requirements

1. Create a Zustand store with the following state:
   - `nodes`: Array of React Flow nodes (typed with `CanvasNodeData`)
   - `edges`: Array of React Flow edges
2. Implement the following actions:
   - `onNodesChange`: Handler for React Flow's `onNodesChange` callback (handles drag, select, remove)
   - `onEdgesChange`: Handler for React Flow's `onEdgesChange` callback
   - `addNode`: Add a new node at a given position with given data
3. Store must use React Flow's `applyNodeChanges` and `applyEdgeChanges` helpers for change handling
4. State must persist during the session (not lost on component re-render)
5. Store file located at `frontend/src/store/canvas-store.ts`

## Implementation Plan

1. Create `frontend/src/store/canvas-store.ts`
2. Define the store interface (`CanvasStore`) using types from task 2-2
3. Implement the store using `zustand`'s `create` function
4. Use `applyNodeChanges` / `applyEdgeChanges` from `@xyflow/react` in change handlers
5. Implement `addNode` action that creates a properly typed React Flow node

**Dependencies**: Task 2-2 (types and constants must exist)

## Test Plan

- TypeScript compilation passes without errors
- Unit test: store initializes with empty nodes/edges arrays
- Unit test: `addNode` adds a node to the store's nodes array with correct structure
- Unit test: `onNodesChange` applies position changes correctly

## Verification

_To be completed during implementation._

## Files Modified

_To be completed during implementation._
