# [6-1] Docker SDK Integration & Client Wrapper

[Back to task list](./tasks.md)

## Description

Add the Docker SDK for Go as a project dependency, create a research guide documenting key API patterns, and implement a client wrapper that initializes the Docker SDK client and handles connection to the Docker daemon. This is the foundation that all other PBI-6 tasks build upon.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2026-02-19 06:18:07 | Created | N/A | Proposed | Task file created | AI_Agent |
| 2026-02-19 06:54:29 | Status Change | Agreed | InProgress | Started implementation | AI_Agent |
| 2026-02-19 06:59:01 | Status Change | InProgress | Review | Implementation complete, internal AI review passed | AI_Agent |

## Requirements

1. Add `github.com/docker/docker` and required transitive dependencies to `go.mod`
2. Create a Docker SDK research guide at `docs/delivery/6/6-1-docker-sdk-guide.md` with date-stamped API usage examples for: client initialization, container operations, network operations, and image pulling
3. Implement a client wrapper in `backend/internal/docker/client.go` that:
   - Creates a Docker SDK client using the default socket/environment
   - Provides a `Ping()` method to verify daemon connectivity
   - Provides a `Close()` method for cleanup
   - Returns meaningful errors when the daemon is not available
4. Compile-time interface assertion pattern (consistent with existing `storage` package)

## Implementation Plan

1. Research Docker SDK for Go API via web — document findings in guide file
2. Run `go get github.com/docker/docker/client github.com/docker/docker/api/types`
3. Create `backend/internal/docker/` package
4. Implement `client.go` with `Client` struct wrapping the Docker SDK client
5. Constructor `NewClient()` initializes the SDK client with sensible defaults
6. `Ping()` calls Docker API ping to verify daemon is reachable
7. `Close()` closes the underlying SDK client

**External Packages**: This task requires research and a guide document for: Docker SDK for Go (`github.com/docker/docker`)

## Test Plan

- Verify `go build ./...` compiles without errors after adding dependency
- Unit test: `NewClient()` returns a non-nil client (mocking the Docker SDK is not practical here; test structure only)
- Unit test: `Close()` does not panic on a valid client
- Integration note: actual daemon connectivity will be tested in task 6-7 (E2E)

## Verification

- `go build ./...` compiles without errors
- All tests pass (`go test ./internal/docker/ -v`)
- `go vet ./...` passes
- `golangci-lint run ./...` reports 0 issues
- Internal AI review: pass (after addressing interface assertion and Ping test)

## Files Modified

- `backend/internal/docker/client.go` — DockerAPI interface, Client wrapper, Ping, Close
- `backend/internal/docker/client_test.go` — Unit tests for NewClient, Close, Ping
- `backend/go.mod` — Added `github.com/docker/docker v28.5.2+incompatible` and transitive deps
- `backend/go.sum` — Updated checksums
- `docs/delivery/6/6-1-docker-sdk-guide.md` — Docker SDK research guide with API examples
